{% extends 'base.html.twig' %}

{% block title %}Nouveau sondage{% endblock %}

{% block body %}
    <script>
        let int = 1;
        let nbquestion = 1;

        function myFunction() {
            int ++
            document.getElementById("cpt").innerHTML = "<input name=\"nbquestion\" id=\"nbquestion\" type=\"hidden\" value =" + int +">";
            document.getElementById("demo"+int).innerHTML += "<label> Intitulé: <br> <input type=\"text\" name=\"intitule"+ int+"\"> </label> <br><br> <label for=\"type-select\">Choisissez un type:</label><br> <select name=\"type"+ int+"\" id=\"type-select\" onchange=\"choixtypebis(value,int)\" > <option value=\"\">--Choisissez une option--</option> <option value=\"multiple\">Question à choix multiple</option> <option value=\"ouverte\">Question ouverte</option> <option value=\"oui_non\">Question oui/non</option></select> <br><br> <label> Choix: <br> <p id=\"typequestion" + int +"\"></p><p id=\"demo" + (int+1) + "\"><br> </label> <br><br>";
        }
        function choixtypebis(val,id) {
            let choix;
            switch (val){
                case "multiple":
                    nbquestion =1
                    choix = "Réponse 1 :<input type=\"text\" name=\"reponse"+int+ "-"+nbquestion+"\"><br><p id =\"" + int + "-" + (nbquestion+1) +"\"><button type=\"button\" onclick=\"newreponse("+ int + "," + (nbquestion + 1)+ ")\"> + Ajouter une reponse </button></p><br>"
                    break
                case "ouverte":
                    choix = "Question ouverte: Aucun affichage disponible"
                    break
                case "oui_non":
                    choix = "<label>Oui <input type=\"radio\" name=\"visibilite\" value=\"oui\" checked> </label> <label>Non <input type=\"radio\" name=\"visibilite\" value=\"non\"> </label>"
                    break
                default:
                    choix =""
                    break
            }
           let idbis = "typequestion" + id
            document.getElementById(idbis).innerHTML = choix
        }
        function newreponse(nbquest, nbrep){
            nbquestion ++
            document.getElementById(nbquest + "-" + nbrep).innerHTML = "Réponse "+nbquestion+":<input type=\"text\" name=\"reponse"+nbquestion+"\"><br><p id=\""+ nbquest + "-" + (nbrep+1) + "\"><button type=\"button\" onclick=\"newreponse("+ nbquest +"," + (nbrep+1) +")\"> + Ajouter une reponse </button><button type=\"button\" onclick=\"removereponse("+ nbquest +"," + (nbrep+1) +")\"></button></p>"
        }

        function removereponse(quest,rep){
            nbquestion --
            document.getElementById(quest + "-" + rep).delete();
        }


    </script>

    <h1>Create new Sondage</h1>
    <form action="./create" id ="form" method="POST" >
        <p id ="cpt">       <input name="nbquestion" id="nbquestion" type="hidden" value ="1">
        </p>
        <label >Visibilité</label>
        <br>
        <label>public
            <input type="radio" name="visibilite" value="public" checked>
        </label>
        <label>privé
            <input type="radio" name="visibilite" value="prive" required>
        </label>
        <br><br>
        <label> Nom:
            <br>
            <input type="text" autocomplete="off" name="nom" required>
        </label>
        <br>
        <br>
        <label> Introduction:
            <br>
            <input type="text" autocomplete="off" name="introduction" style="height:140px" required>
        </label>
        <br>
        {{ include('sondage/createquestion.html.twig') }}
        <br>
        <p id="demo2"></p>
        <button type="button" onclick="myFunction()"> + Ajouter une question </button><br><br>

        <button type="submit"> Créer </button>
    </form>


    <a href="{{ path('app_sondage_index') }}">back to list</a>
{% endblock %}